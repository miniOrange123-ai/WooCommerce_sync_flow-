<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WooCommerce Sync Flow Comparison</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .tab {
            flex: 1;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            background: transparent;
            font-size: 1rem;
            font-weight: 500;
            color: #6c757d;
            position: relative;
        }

        .tab:hover {
            background: #e9ecef;
            color: #495057;
        }

        .tab.active {
            background: white;
            color: #007bff;
            border-bottom: 3px solid #007bff;
        }

        .tab-content {
            display: none;
            padding: 40px;
            min-height: 600px;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .content-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .content-header h2 {
            font-size: 2rem;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .content-header p {
            font-size: 1.1rem;
            color: #6c757d;
            max-width: 600px;
            margin: 0 auto;
        }

        .diagram-container {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .diagram-container:hover {
            border-color: #007bff;
            box-shadow: 0 10px 25px rgba(0, 123, 255, 0.1);
        }

        .diagram-container img {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .diagram-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 30px;
        }

        .comparison-item {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #e9ecef;
        }

        .comparison-item h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .comparison-item ul {
            list-style: none;
            padding: 0;
        }

        .comparison-item li {
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
            color: #495057;
        }

        .comparison-item li:last-child {
            border-bottom: none;
        }

        .comparison-item li:before {
            content: "•";
            color: #007bff;
            font-weight: bold;
            margin-right: 10px;
        }

        .key-differences {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
        }

        .key-differences h3 {
            margin-bottom: 20px;
            font-size: 1.4rem;
        }

        .key-differences ul {
            list-style: none;
            padding: 0;
        }

        .key-differences li {
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            font-size: 1.1rem;
        }

        .key-differences li:last-child {
            border-bottom: none;
        }

        .key-differences li:before {
            content: "→";
            margin-right: 10px;
            font-weight: bold;
        }

        .flow-description {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
        }

        .flow-description h4 {
            color: #1976d2;
            margin-bottom: 10px;
        }

        .flow-description p {
            color: #424242;
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            .tabs {
                flex-direction: column;
            }
            
            .comparison-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .tab-content {
                padding: 20px;
            }
        }

        /* Preview Tab Styles */
        .preview-sub-tabs {
            display: flex;
            background: #f8f9fa;
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
        }

        .preview-sub-tab {
            flex: 1;
            padding: 15px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            background: transparent;
            font-size: 1rem;
            font-weight: 500;
            color: #6c757d;
        }

        .preview-sub-tab:hover {
            background: #e9ecef;
            color: #495057;
        }

        .preview-sub-tab.active {
            background: #007bff;
            color: white;
        }

        .preview-content {
            display: none;
        }

        .preview-content.active {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }

        .preview-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .preview-header h3 {
            font-size: 1.8rem;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .preview-header p {
            color: #6c757d;
            font-size: 1.1rem;
        }

        .sync-simulation {
            max-width: 800px;
            margin: 0 auto;
        }

        .step-container {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            margin-bottom: 20px;
            overflow: hidden;
            transition: all 0.3s ease;
            position: relative;
        }

        .step-container:hover {
            border-color: #007bff;
            box-shadow: 0 5px 15px rgba(0, 123, 255, 0.1);
        }

        .step-container.hidden {
            display: none;
        }

        /* Connecting line between steps */
        .step-container:not(:last-child)::after {
            content: '';
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 3px;
            height: 20px;
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
            z-index: 1;
        }

        /* Arrow at the end of connecting line */
        .step-container:not(:last-child)::before {
            content: '▼';
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            color: #007bff;
            font-size: 12px;
            z-index: 2;
        }

        /* Hide connecting line for last step */
        .step-container:last-child::after,
        .step-container:last-child::before {
            display: none;
        }

        /* Progress indicator */
        .step-container.completed {
            border-color: #28a745;
            background: linear-gradient(135deg, rgba(40, 167, 69, 0.05) 0%, rgba(32, 201, 151, 0.05) 100%);
        }

        .step-container.completed .step-header {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }

        .step-header {
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
            color: white;
            padding: 20px;
            display: flex;
            align-items: center;
        }

        .step-number {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
        }

        .step-header h4 {
            margin: 0;
            font-size: 1.3rem;
        }

        .step-content {
            padding: 25px;
        }

        .step-content p {
            margin-bottom: 20px;
            color: #495057;
            line-height: 1.6;
        }

        .step-content ul {
            list-style: none;
            padding: 0;
            margin: 15px 0;
        }

        .step-content ul li {
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
            color: #495057;
            position: relative;
            padding-left: 20px;
        }

        .step-content ul li:last-child {
            border-bottom: none;
        }

        .step-content ul li:before {
            content: "→";
            color: #007bff;
            font-weight: bold;
            position: absolute;
            left: 0;
        }

        .step-content .function-name {
            background: #e3f2fd;
            padding: 8px 12px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            color: #1976d2;
            display: inline-block;
            margin: 5px 0;
        }

        .step-content .hook-name {
            background: #fff3e0;
            padding: 6px 10px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            color: #f57c00;
            display: inline-block;
            margin: 3px 0;
        }

        .step-content .section-title {
            font-weight: 600;
            color: #2c3e50;
            margin: 15px 0 8px 0;
            font-size: 1.1rem;
        }

        .step-content .process-detail {
            background: #f8f9fa;
            border-left: 4px solid #007bff;
            padding: 12px 15px;
            margin: 10px 0;
            border-radius: 0 6px 6px 0;
        }

        .step-content .process-detail h5 {
            color: #007bff;
            margin-bottom: 8px;
            font-size: 1rem;
        }

        .step-content .process-detail p {
            margin: 5px 0;
            color: #495057;
            font-size: 0.95rem;
        }

        .step-animation {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
            gap: 10px;
        }

        .process-box {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 12px 20px;
            font-weight: 500;
            color: #495057;
            text-align: center;
            min-width: 120px;
            transition: all 0.3s ease;
        }

        .process-box.success {
            background: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }

        .arrow {
            font-size: 1.5rem;
            color: #007bff;
            font-weight: bold;
            margin: 0 10px;
        }

        .sync-button {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
        }

        .sync-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
        }

        .sync-button.reset {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
            box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3);
        }

        .sync-button.reset:hover {
            box-shadow: 0 6px 20px rgba(108, 117, 125, 0.4);
        }

        @media (max-width: 768px) {
            .preview-sub-tabs {
                flex-direction: column;
            }
            
            .step-animation {
                flex-direction: column;
            }
            
            .arrow {
                transform: rotate(90deg);
                margin: 10px 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>miniOrange WooCommerce Sync Flow</h1>
            <p>Comprehensive analysis of old vs new synchronization approaches</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('basic-old')">Basic Old Sync</button>
            <button class="tab" onclick="showTab('basic-new')">Basic New Sync</button>
            <button class="tab" onclick="showTab('old-flow')">Old Sync Flow</button>
            <button class="tab" onclick="showTab('new-flow')">New Sync Flow</button>
            <button class="tab" onclick="showTab('old-backup')">Old Backup Flow</button>
            <button class="tab" onclick="showTab('new-backup')">New Backup Flow</button>
            <button class="tab" onclick="showTab('preview')">Interactive Preview</button>
            <button class="tab" onclick="showTab('comparison')">Key Differences</button>
        </div>

        <!-- Basic Old Sync Tab -->
        <div id="basic-old" class="tab-content active">
            <div class="content-header">
                <h2>Basic Old Sync Flow</h2>
                <p>Connection-centric approach requiring manual sync for each API connection</p>
            </div>
            
            <div class="flow-description">
                <h4>Overview</h4>
                <p>In the old sync flow, each API is treated as a separate connection that must be manually synchronized individually. Users need to start sync for each connection separately to sync all products and their information. This requires manual scheduling and management of each connection's sync process.</p>
            </div>

            <div class="diagram-container">
                <div class="diagram-title">Connection Sync Sequence Diagram</div>
                <img src="basic old flow.png" alt="Basic Old Sync Flow Diagram">
            </div>

            <div class="flow-description">
                <h4>Key Characteristics</h4>
                <p>• <strong>Connection-centric:</strong> Each API is a separate connection<br>
                • <strong>Manual Management:</strong> Must start sync for each connection individually<br>
                • <strong>Separate Scheduling:</strong> Each connection requires its own sync scheduling<br>
                • <strong>Isolated Processing:</strong> No relationship between connections<br>
                • <strong>User-intensive:</strong> Requires manual intervention for each connection</p>
            </div>
        </div>

        <!-- Basic New Sync Tab -->
        <div id="basic-new" class="tab-content">
            <div class="content-header">
                <h2>Basic New Sync Flow</h2>
                <p>Supplier-centric approach with automatic connection management</p>
            </div>
            
            <div class="flow-description">
                <h4>Overview</h4>
                <p>The new sync flow introduces a supplier-centric architecture where you create one supplier and add all related connections under that supplier. Instead of manually syncing each connection, you simply start the supplier sync, and the system automatically handles running sync for all related connections one by one based on priority.</p>
            </div>

            <div class="diagram-container">
                <div class="diagram-title">Supplier Sync Sequence Diagram</div>
                <img src="basic new flow.png" alt="Basic New Sync Flow Diagram">
            </div>

            <div class="flow-description">
                <h4>Key Characteristics</h4>
                <p>• <strong>Supplier-centric:</strong> One supplier contains multiple related connections<br>
                • <strong>Automatic Management:</strong> Start supplier sync, system handles connections internally<br>
                • <strong>Priority-based:</strong> Connections processed in priority order<br>
                • <strong>Unified Scheduling:</strong> Single sync operation for entire supplier<br>
                • <strong>User-friendly:</strong> One-click sync for all related connections</p>
            </div>
        </div>

        <!-- Old Sync Flow Tab -->
        <div id="old-flow" class="tab-content">
            <div class="content-header">
                <h2>Detailed Old Sync Flow</h2>
                <p>Manual connection-by-connection synchronization process</p>
            </div>
            
            <div class="flow-description">
                <h4>Overview</h4>
                <p>The detailed old sync flow demonstrates the complex manual process required when each API connection must be synchronized separately. Users must initiate, schedule, and monitor each connection individually, making it time-consuming and error-prone for suppliers with multiple connections.</p>
            </div>

            <div class="diagram-container">
                <div class="diagram-title">WooCommerce Product Sync - Function Call Flow</div>
                <img src="old sync flow .png" alt="Detailed Old Sync Flow Diagram">
            </div>

            <div class="flow-description">
                <h4>Process Flow</h4>
                <p>• <strong>Manual Initiation:</strong> User must start sync for each connection separately<br>
                • <strong>Individual Scheduling:</strong> Each connection requires separate cron scheduling<br>
                • <strong>Isolated Processing:</strong> No coordination between connections<br>
                • <strong>API calls:</strong> Retrieve product data for each connection independently<br>
                • <strong>Product Processing:</strong> Handle products for each connection separately<br>
                • <strong>WooCommerce Integration:</strong> Create/update products per connection<br>
                • <strong>Separate Monitoring:</strong> Track progress for each connection individually</p>
            </div>
        </div>

        <!-- New Sync Flow Tab -->
        <div id="new-flow" class="tab-content">
            <div class="content-header">
                <h2>Detailed New Sync Flow</h2>
                <p>Automated supplier-level synchronization with internal connection management</p>
            </div>
            
            <div class="flow-description">
                <h4>Overview</h4>
                <p>The detailed new sync flow shows how the system automatically manages multiple connections under a single supplier. Users only need to start the supplier sync, and the system internally handles the coordination, priority management, and sequential processing of all related connections.</p>
            </div>

            <div class="diagram-container">
                <div class="diagram-title">WooCommerce Supplier Sync Flow - Priority Based Connection Sync</div>
                <img src="new sync  flow .png" alt="Detailed New Sync Flow Diagram">
            </div>

            <div class="flow-description">
                <h4>Process Flow</h4>
                <p>• <strong>Single Initiation:</strong> User starts supplier sync once<br>
                • <strong>Automatic Coordination:</strong> System manages all connections internally<br>
                • <strong>Priority-based Processing:</strong> Connections processed in priority order<br>
                • <strong>Sequential Execution:</strong> One connection completes before next starts<br>
                • <strong>Unified Monitoring:</strong> Track progress at supplier level<br>
                • <strong>Enhanced Recovery:</strong> Better error handling and backup mechanisms<br>
                • <strong>Comprehensive Hooks:</strong> More customization points throughout process</p>
            </div>
        </div>

        <!-- Old Backup Flow Tab -->
        <div id="old-backup" class="tab-content">
            <div class="content-header">
                <h2>Old Backup Sync Flow</h2>
                <p>Simple backup monitoring for individual connection synchronization</p>
            </div>
            
            <div class="flow-description">
                <h4>Overview</h4>
                <p>The old backup sync flow provides basic monitoring for individual connection synchronization. It sets up a backup cron job that monitors the sync progress and can resume or restart the sync if it gets stuck. This approach focuses on monitoring a single connection at a time.</p>
            </div>

            <div class="diagram-container">
                <div class="diagram-title">WooCommerce Product Sync - Simple Backup Sync Flow</div>
                <img src="old backup sync flow.png" alt="Old Backup Sync Flow Diagram">
            </div>

            <div class="flow-description">
                <h4>Process Flow</h4>
                <p>• <strong>Backup Setup:</strong> Sync Manager sets up backup monitoring for individual connection<br>
                • <strong>Cron Scheduling:</strong> WordPress schedules backup cron to run every few minutes<br>
                • <strong>Status Monitoring:</strong> Backup cron checks sync status and batch analytics<br>
                • <strong>Issue Detection:</strong> Detects if sync is stuck or needs attention<br>
                • <strong>Recovery Action:</strong> Resumes sync or schedules next batch if needed<br>
                • <strong>Completion Handling:</strong> Clears backup cron when sync completes</p>
            </div>

            <div class="flow-description">
                <h4>Key Characteristics</h4>
                <p>• <strong>Connection-focused:</strong> Monitors single connection sync progress<br>
                • <strong>Basic Recovery:</strong> Simple resume/restart mechanisms<br>
                • <strong>Periodic Monitoring:</strong> Runs backup checks every few minutes<br>
                • <strong>Manual Intervention:</strong> May require manual handling for complex issues<br>
                • <strong>Limited Scope:</strong> Only handles one connection at a time</p>
            </div>
        </div>

        <!-- New Backup Flow Tab -->
        <div id="new-backup" class="tab-content">
            <div class="content-header">
                <h2>New Backup Sync Flow</h2>
                <p>Advanced backup monitoring for supplier-level synchronization with connection management</p>
            </div>
            
            <div class="flow-description">
                <h4>Overview</h4>
                <p>The new backup sync flow provides comprehensive monitoring for supplier-level synchronization. It includes both supplier-level and connection-level backup monitoring, allowing the system to track progress across multiple connections and automatically handle transitions between connections based on priority.</p>
            </div>

            <div class="diagram-container">
                <div class="diagram-title">WooCommerce Supplier Sync - Simple Backup Sync Flow</div>
                <img src="new backup sync flow.png" alt="New Backup Sync Flow Diagram">
            </div>

            <div class="flow-description">
                <h4>Process Flow</h4>
                <p>• <strong>Supplier Backup Setup:</strong> Supplier Manager sets up backup monitoring for entire supplier<br>
                • <strong>Multi-level Monitoring:</strong> Monitors both supplier progress and individual connections<br>
                • <strong>Connection Status Tracking:</strong> Tracks status of all connections (Connection1, Connection2, Connection3)<br>
                • <strong>Priority-based Transitions:</strong> Automatically moves to next priority connection when current completes<br>
                • <strong>Enhanced Recovery:</strong> Can resume stuck connections or restart entire supplier sync<br>
                • <strong>Connection-level Backup:</strong> Individual connection monitoring with batch-level recovery</p>
            </div>

            <div class="flow-description">
                <h4>Key Characteristics</h4>
                <p>• <strong>Supplier-focused:</strong> Monitors entire supplier sync progress across multiple connections<br>
                • <strong>Multi-level Recovery:</strong> Both supplier-level and connection-level recovery mechanisms<br>
                • <strong>Automatic Coordination:</strong> Handles transitions between connections automatically<br>
                • <strong>Priority Management:</strong> Respects connection priorities during recovery<br>
                • <strong>Comprehensive Monitoring:</strong> Tracks progress at both supplier and connection levels<br>
                • <strong>Enhanced Hooks:</strong> More backup-related hooks for customization</p>
            </div>

            <div class="flow-description">
                <h4>Available Backup Hooks</h4>
                <p>• <strong>mo_wcps_supplier_sync_backup_cron:</strong> Supplier backup monitoring cron hook<br>
                • <strong>mo_wcps_connection_sync_backup_cron:</strong> Connection backup monitoring cron hook<br>
                • <strong>mo_wcps_connection_completed:</strong> Called when connection sync completes<br>
                • <strong>mo_wcps_supplier_sync_completed:</strong> Called when all connections complete</p>
            </div>
        </div>

        <!-- Preview Tab -->
        <div id="preview" class="tab-content">
            <div class="content-header">
                <h2>Interactive Sync Flow Preview</h2>
                <p>Experience the sync process step-by-step with detailed function calls and hooks</p>
            </div>

            <!-- Preview Sub-tabs -->
            <div class="preview-sub-tabs">
                <button class="preview-sub-tab active" onclick="showPreviewTab('old-preview')">Old Sync Flow</button>
                <button class="preview-sub-tab" onclick="showPreviewTab('new-preview')">New Sync Flow</button>
            </div>

            <!-- Old Sync Preview -->
            <div id="old-preview" class="preview-content active">
                <div class="preview-header">
                    <h3>Old Sync Flow - Step by Step Details</h3>
                    <p>Connection-centric approach with detailed function calls and hooks</p>
                </div>

                <div class="sync-simulation">
                    <div class="step-container" id="old-step-1">
                        <div class="step-header">
                            <span class="step-number">1</span>
                            <h4>User Initiates Sync</h4>
                        </div>
                        <div class="step-content">
                            <div class="step-animation">
                                <div class="process-box">User</div>
                                <div class="arrow">→</div>
                                <div class="process-box">Click "Start Sync"</div>
                            </div>
                            <p><strong>Action:</strong> User clicks "Start Sync" button for a single connection</p>
                            <div class="section-title">Function:</div>
                            <div class="function-name">mo_wcps_dropdown_action_redirect('connection_name', 'play')</div>
                            <div class="section-title">What it does:</div>
                            <ul>
                                <li>Triggers the sync initiation process for a specific connection</li>
                                <li>Validates user permissions and connection status</li>
                                <li>Redirects to the sync action handler</li>
                            </ul>
                            <div class="process-detail">
                                <h5>Process Details:</h5>
                                <p>This is the entry point where the user initiates the sync process. The system validates that the connection exists and the user has proper permissions to start the sync operation.</p>
                            </div>
                            <div class="section-title">Hooks:</div>
                            <p>None</p>
                            <button class="sync-button" onclick="nextOldStep(2)">Continue</button>
                        </div>
                    </div>

                    <div class="step-container hidden" id="old-step-2">
                        <div class="step-header">
                            <span class="step-number">2</span>
                            <h4>UI Handler Processing</h4>
                        </div>
                        <div class="step-content">
                            <div class="step-animation">
                                <div class="process-box">UI Handler</div>
                                <div class="arrow">→</div>
                                <div class="process-box">handle_action('mowcpsstartsync')</div>
                            </div>
                            <div class="section-title">Function:</div>
                            <div class="function-name">handle_action('mowcpsstartsync')</div>
                            <div class="section-title">What it does:</div>
                            <ul>
                                <li>Checks if sync is already running for this connection</li>
                                <li>Updates sync status to 'started' in the database</li>
                                <li>Calls enqueue_product_sync() to setup the sync process</li>
                                <li>Redirects user to the analytics page to monitor progress</li>
                            </ul>
                            <div class="process-detail">
                                <h5>Process Details:</h5>
                                <p>This function acts as the main controller for sync initiation. It prevents multiple syncs from running simultaneously for the same connection and ensures proper state management. The function also handles user feedback by redirecting to the analytics page where users can monitor the sync progress.</p>
                            </div>
                            <div class="section-title">Hooks:</div>
                            <p>None</p>
                            <button class="sync-button" onclick="nextOldStep(3)">Continue</button>
                        </div>
                    </div>

                    <div class="step-container hidden" id="old-step-3">
                        <div class="step-header">
                            <span class="step-number">3</span>
                            <h4>Cron Manager Setup</h4>
                        </div>
                        <div class="step-content">
                            <div class="step-animation">
                                <div class="process-box">Cron Manager</div>
                                <div class="arrow">→</div>
                                <div class="process-box">enqueue_product_sync()</div>
                            </div>
                            <div class="section-title">Function:</div>
                            <div class="function-name">enqueue_product_sync(connection_name)</div>
                            <div class="section-title">What it does:</div>
                            <ul>
                                <li>Creates a new Sync_Analytics object to track sync progress</li>
                                <li>Sets up analytics with 'complete_connection' type for full sync</li>
                                <li>Creates Sync_Manager object to handle the actual sync process</li>
                                <li>Schedules WordPress cron job: mo_wcps_product_sync_cron</li>
                                <li>Updates connection status to 'Sync in queue'</li>
                            </ul>
                            <div class="process-detail">
                                <h5>Process Details:</h5>
                                <p>This function prepares the sync infrastructure by creating analytics tracking and scheduling the actual sync job. The Sync_Analytics object will track metrics like products processed, time taken, and success/failure rates. The cron job is scheduled to run in 2 seconds to allow the current request to complete.</p>
                            </div>
                            <div class="section-title">Hooks:</div>
                            <p>None</p>
                            <button class="sync-button" onclick="nextOldStep(4)">Continue</button>
                        </div>
                    </div>

                    <div class="step-container hidden" id="old-step-4">
                        <div class="step-header">
                            <span class="step-number">4</span>
                            <h4>WordPress Cron Scheduling</h4>
                        </div>
                        <div class="step-content">
                            <div class="step-animation">
                                <div class="process-box">WordPress</div>
                                <div class="arrow">→</div>
                                <div class="process-box">wp_schedule_single_event()</div>
                            </div>
                            <div class="section-title">Function:</div>
                            <div class="function-name">wp_schedule_single_event()</div>
                            <div class="section-title">What it does:</div>
                            <ul>
                                <li>WordPress core function schedules a one-time cron job</li>
                                <li>Sets the job to run after 2 seconds delay</li>
                                <li>Registers the mo_wcps_product_sync_cron hook</li>
                                <li>Passes connection parameters to the cron job</li>
                            </ul>
                            <div class="process-detail">
                                <h5>Process Details:</h5>
                                <p>WordPress uses its built-in cron system to schedule the sync job. The 2-second delay ensures the current HTTP request completes before the sync starts, preventing timeout issues. The cron job will execute the mo_wcps_product_sync_cron function with the connection details.</p>
                            </div>
                            <div class="section-title">Hooks:</div>
                            <p>None</p>
                            <button class="sync-button" onclick="nextOldStep(5)">Continue</button>
                        </div>
                    </div>

                    <div class="step-container hidden" id="old-step-5">
                        <div class="step-header">
                            <span class="step-number">5</span>
                            <h4>Sync Manager Initialization</h4>
                        </div>
                        <div class="step-content">
                            <div class="step-animation">
                                <div class="process-box">Sync Manager</div>
                                <div class="arrow">→</div>
                                <div class="process-box">start_sync()</div>
                            </div>
                            <div class="section-title">Function:</div>
                            <div class="function-name">start_sync()</div>
                            <div class="section-title">What it does:</div>
                            <ul>
                                <li>Initializes Default_Apps_Factory to handle API connections</li>
                                <li>Sets up backup cron monitoring for sync recovery</li>
                                <li>Calls start_sync_process() to begin actual product sync</li>
                                <li>Calls end_sync() to finalize the sync process</li>
                                <li>Manages sync state and error handling</li>
                            </ul>
                            <div class="process-detail">
                                <h5>Process Details:</h5>
                                <p>The Sync Manager is the main orchestrator of the sync process. It initializes the API factory which handles different supplier APIs (Amrod, Barron, etc.), sets up backup monitoring to detect stuck syncs, and manages the entire sync lifecycle from start to completion.</p>
                            </div>
                            <div class="section-title">Hooks:</div>
                            <div class="hook-name">mo_wcps_perform_action_before_sync</div>
                            <p>Called before sync starts, allowing custom actions</p>
                            <button class="sync-button" onclick="nextOldStep(6)">Continue</button>
                        </div>
                    </div>

                    <div class="step-container hidden" id="old-step-6">
                        <div class="step-header">
                            <span class="step-number">6</span>
                            <h4>API Data Retrieval</h4>
                        </div>
                        <div class="step-content">
                            <div class="step-animation">
                                <div class="process-box">Sync Handler</div>
                                <div class="arrow">→</div>
                                <div class="process-box">handle_api_sync()</div>
                                <div class="arrow">→</div>
                                <div class="process-box">External API</div>
                            </div>
                            <div class="section-title">Function:</div>
                            <div class="function-name">handle_api_sync()</div>
                            <div class="section-title">What it does:</div>
                            <ul>
                                <li>Sets memory and time limits for API processing</li>
                                <li>Calls set_product_data() to fetch products from external API</li>
                                <li>Calls filter_product_data() to apply custom filters</li>
                                <li>Calls sync_products() to process and sync products</li>
                                <li>Handles API authentication and error responses</li>
                            </ul>
                            <div class="process-detail">
                                <h5>Process Details:</h5>
                                <p>This is where the actual sync begins. The function makes API calls to external suppliers (like Amrod, Barron, etc.) to retrieve product data. It applies memory and time limits to prevent server overload, filters the data based on user settings, and then processes each product for WooCommerce integration.</p>
                            </div>
                            <div class="section-title">Hooks:</div>
                            <p>None</p>
                            <button class="sync-button" onclick="nextOldStep(7)">Continue</button>
                        </div>
                    </div>

                    <div class="step-container hidden" id="old-step-7">
                        <div class="step-header">
                            <span class="step-number">7</span>
                            <h4>Product Processing</h4>
                        </div>
                        <div class="step-content">
                            <div class="step-animation">
                                <div class="process-box">Sync Products</div>
                                <div class="arrow">→</div>
                                <div class="process-box">sync_products()</div>
                            </div>
                            <div class="section-title">Function:</div>
                            <div class="function-name">sync_products() [on sync class]</div>
                            <div class="section-title">What it does:</div>
                            <ul>
                                <li>Loops through each product retrieved from the API</li>
                                <li>Creates product objects (Simple or Variable products)</li>
                                <li>Calls set_fields() to map API data to WooCommerce fields</li>
                                <li>Calls save() to create/update products in WooCommerce</li>
                                <li>Updates analytics counters (processed, added, updated, failed)</li>
                                <li>Applies product filters and transformations</li>
                            </ul>
                            <div class="process-detail">
                                <h5>Process Details:</h5>
                                <p>This function processes each product individually. It maps external API data to WooCommerce product fields, handles both simple and variable products, applies user-defined filters, and creates or updates products in WooCommerce. The function also tracks progress for analytics and error reporting.</p>
                            </div>
                            <div class="section-title">Hooks:</div>
                            <div class="hook-name">mo_wcps_data_alteration_filter</div>
                            <p>Called before processing products, allows data modification</p>
                            <button class="sync-button" onclick="nextOldStep(8)">Continue</button>
                        </div>
                    </div>

                    <div class="step-container hidden" id="old-step-8">
                        <div class="step-header">
                            <span class="step-number">8</span>
                            <h4>Product Creation/Update</h4>
                        </div>
                        <div class="step-content">
                            <div class="step-animation">
                                <div class="process-box">MO Product</div>
                                <div class="arrow">→</div>
                                <div class="process-box">save()</div>
                                <div class="arrow">→</div>
                                <div class="process-box">WooCommerce</div>
                            </div>
                            <div class="section-title">Function:</div>
                            <div class="function-name">save()</div>
                            <div class="section-title">What it does:</div>
                            <ul>
                                <li>Checks if product already exists in WooCommerce</li>
                                <li>If exists: calls update_product() (if update is enabled)</li>
                                <li>If new: calls add_product() (if add is enabled)</li>
                                <li>Handles product images, categories, and attributes</li>
                                <li>Returns product details (ID, status, errors)</li>
                                <li>Manages product variations for variable products</li>
                            </ul>
                            <div class="process-detail">
                                <h5>Process Details:</h5>
                                <p>This function is responsible for the actual creation or update of products in WooCommerce. It checks existing products by SKU or external ID, handles product images, categories, attributes, and variations. The function respects user settings for add/update operations and provides detailed feedback for each product operation.</p>
                            </div>
                            <div class="section-title">Hooks:</div>
                            <p>None</p>
                            <button class="sync-button" onclick="nextOldStep(9)">Continue</button>
                        </div>
                    </div>

                    <div class="step-container hidden" id="old-step-9">
                        <div class="step-header">
                            <span class="step-number">9</span>
                            <h4>Sync Completion</h4>
                        </div>
                        <div class="step-content">
                            <div class="step-animation">
                                <div class="process-box">Sync Manager</div>
                                <div class="arrow">→</div>
                                <div class="process-box">end_sync()</div>
                                <div class="arrow">→</div>
                                <div class="process-box success">Completed</div>
                            </div>
                            <div class="section-title">Function:</div>
                            <div class="function-name">end_sync(sync_end_status)</div>
                            <div class="section-title">What it does:</div>
                            <ul>
                                <li>Updates final analytics with completion statistics</li>
                                <li>Sets sync end time and calculates total duration</li>
                                <li>Updates sync running status to 'completed'</li>
                                <li>Handles completion/abort/pause status appropriately</li>
                                <li>Clears scheduled crons and backup monitoring</li>
                                <li>Logs sync completion and any errors encountered</li>
                            </ul>
                            <div class="process-detail">
                                <h5>Process Details:</h5>
                                <p>This function finalizes the sync process by updating analytics, cleaning up resources, and logging results. It provides a summary of the sync operation including products processed, time taken, and any errors. The function also ensures proper cleanup of WordPress cron jobs and backup monitoring systems.</p>
                            </div>
                            <div class="section-title">Hooks:</div>
                            <p>None</p>
                            <button class="sync-button reset" onclick="resetOldSync()">Reset Simulation</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- New Sync Preview -->
            <div id="new-preview" class="preview-content">
                <div class="preview-header">
                    <h3>New Sync Flow - Step by Step Details</h3>
                    <p>Supplier-centric approach with priority-based connection management</p>
                </div>

                <div class="sync-simulation">
                    <div class="step-container" id="new-step-1">
                        <div class="step-header">
                            <span class="step-number">1</span>
                            <h4>User Initiates Supplier Sync</h4>
                        </div>
                        <div class="step-content">
                            <div class="step-animation">
                                <div class="process-box">User</div>
                                <div class="arrow">→</div>
                                <div class="process-box">Click "Start Supplier Sync"</div>
                            </div>
                            <div class="section-title">Action:</div>
                            <p>User clicks "Start Supplier Sync" button</p>
                            <div class="section-title">Function:</div>
                            <div class="function-name">handle_supplier_sync_action()</div>
                            <div class="section-title">What it does:</div>
                            <ul>
                                <li>Checks if supplier sync is already running</li>
                                <li>Updates supplier status to 'started' in database</li>
                                <li>Retrieves all connections associated with the supplier</li>
                                <li>Validates supplier configuration and permissions</li>
                                <li>Redirects to supplier analytics page</li>
                            </ul>
                            <div class="process-detail">
                                <h5>Process Details:</h5>
                                <p>This function initiates the supplier-level sync process. Unlike the old system where each connection was synced separately, this function prepares to sync all connections under a single supplier. It validates the supplier exists and has proper configuration before proceeding.</p>
                            </div>
                            <div class="section-title">Hooks:</div>
                            <p>None</p>
                            <button class="sync-button" onclick="nextNewStep(2)">Continue</button>
                        </div>
                    </div>

                    <div class="step-container hidden" id="new-step-2">
                        <div class="step-header">
                            <span class="step-number">2</span>
                            <h4>Supplier Manager Setup</h4>
                        </div>
                        <div class="step-content">
                            <div class="step-animation">
                                <div class="process-box">Supplier Manager</div>
                                <div class="arrow">→</div>
                                <div class="process-box">start_supplier_sync()</div>
                            </div>
                            <div class="section-title">Function:</div>
                            <div class="function-name">start_supplier_sync()</div>
                            <div class="section-title">What it does:</div>
                            <ul>
                                <li>Initializes the supplier object with configuration</li>
                                <li>Retrieves priority-sorted connections for the supplier</li>
                                <li>Starts with the highest priority connection first</li>
                                <li>Sets up supplier-level analytics tracking</li>
                                <li>Configures backup monitoring for supplier sync</li>
                            </ul>
                            <div class="process-detail">
                                <h5>Process Details:</h5>
                                <p>The Supplier Manager orchestrates the entire supplier sync process. It retrieves all connections associated with the supplier, sorts them by priority, and prepares to process them sequentially. This is the key difference from the old system - instead of managing individual connections, it manages a collection of related connections.</p>
                            </div>
                            <div class="section-title">Hooks:</div>
                            <div class="hook-name">mo_wcps_perform_action_before_supplier_sync</div>
                            <p>Called before supplier sync starts, allows custom actions</p>
                            <button class="sync-button" onclick="nextNewStep(3)">Continue</button>
                        </div>
                    </div>

                    <div class="step-container hidden" id="new-step-3">
                        <div class="step-header">
                            <span class="step-number">3</span>
                            <h4>Connection Priority Management</h4>
                        </div>
                        <div class="step-content">
                            <div class="step-animation">
                                <div class="process-box">Connection Manager</div>
                                <div class="arrow">→</div>
                                <div class="process-box">get_connections_by_priority()</div>
                            </div>
                            <div class="section-title">Function:</div>
                            <div class="function-name">get_connections_by_priority(supplier_name)</div>
                            <div class="section-title">What it does:</div>
                            <ul>
                                <li>Retrieves all connections for the specified supplier</li>
                                <li>Sorts connections by their priority value (1 = highest)</li>
                                <li>Returns ordered list: [Connection1: Priority 1, Connection2: Priority 2, Connection3: Priority 3]</li>
                                <li>Validates connection status and configuration</li>
                                <li>Filters out disabled or invalid connections</li>
                            </ul>
                            <div class="process-detail">
                                <h5>Process Details:</h5>
                                <p>This function implements the priority-based connection management system. It retrieves all connections associated with a supplier and sorts them by priority. Higher priority connections (lower numbers) are processed first. This ensures that critical connections are synced before less important ones, providing better control over the sync order.</p>
                            </div>
                            <div class="section-title">Hooks:</div>
                            <p>None</p>
                            <button class="sync-button" onclick="nextNewStep(4)">Continue</button>
                        </div>
                    </div>

                    <div class="step-container hidden" id="new-step-4">
                        <div class="step-header">
                            <span class="step-number">4</span>
                            <h4>Start Connection1 (Priority 1)</h4>
                        </div>
                        <div class="step-content">
                            <div class="step-animation">
                                <div class="process-box">Connection Manager</div>
                                <div class="arrow">→</div>
                                <div class="process-box">start_connection_sync(connection1)</div>
                            </div>
                            <div class="section-title">Function:</div>
                            <div class="function-name">start_connection_sync(connection1)</div>
                            <div class="section-title">What it does:</div>
                            <ul>
                                <li>Initiates sync for the highest priority connection (Connection1)</li>
                                <li>Sets Connection1 status to 'in_progress'</li>
                                <li>Creates Connection1-specific analytics tracking</li>
                                <li>Sets up Connection1-level backup monitoring</li>
                                <li>Prepares Connection1 for API data retrieval</li>
                            </ul>
                            <div class="process-detail">
                                <h5>Process Details:</h5>
                                <p>This function starts the sync process for the first (highest priority) connection. It sets up the same infrastructure as the old system but within the context of the supplier sync. The connection will be processed completely before moving to the next priority connection, ensuring sequential processing.</p>
                            </div>
                            <div class="section-title">Hooks:</div>
                            <div class="hook-name">mo_wcps_perform_action_before_connection_sync</div>
                            <p>Called before each connection sync starts</p>
                            <button class="sync-button" onclick="nextNewStep(5)">Continue</button>
                        </div>
                    </div>

                    <div class="step-container hidden" id="new-step-5">
                        <div class="step-header">
                            <span class="step-number">5</span>
                            <h4>Connection1 Product Processing</h4>
                        </div>
                        <div class="step-content">
                            <div class="step-animation">
                                <div class="process-box">Sync Handler</div>
                                <div class="arrow">→</div>
                                <div class="process-box">handle_api_sync(connection1)</div>
                                <div class="arrow">→</div>
                                <div class="process-box">External API</div>
                            </div>
                            <div class="section-title">Function:</div>
                            <div class="function-name">handle_api_sync(connection1)</div>
                            <div class="section-title">What it does:</div>
                            <ul>
                                <li>Set memory limits</li>
                                <li>Make API call for connection1</li>
                                <li>Process products for connection1</li>
                            </ul>
                            <div class="process-detail">
                                <h5>Process Details:</h5>
                                <p>This function processes the first connection in the supplier sync. It sets up the necessary infrastructure for the sync process, including memory limits, API call, and product processing.</p>
                            </div>
                            <div class="section-title">Hooks:</div>
                            <p>None</p>
                            <button class="sync-button" onclick="nextNewStep(6)">Continue</button>
                        </div>
                    </div>

                    <div class="step-container hidden" id="new-step-6">
                        <div class="step-header">
                            <span class="step-number">6</span>
                            <h4>Connection1 Completion</h4>
                        </div>
                        <div class="step-content">
                            <div class="step-animation">
                                <div class="process-box">Connection1</div>
                                <div class="arrow">→</div>
                                <div class="process-box success">Completed</div>
                                <div class="arrow">→</div>
                                <div class="process-box">Supplier Manager</div>
                            </div>
                            <div class="section-title">Function:</div>
                            <div class="function-name">connection1_completed()</div>
                            <div class="section-title">What it does:</div>
                            <ul>
                                <li>Marks Connection1 as completed in the database</li>
                                <li>Updates Connection1 analytics with final statistics</li>
                                <li>Notifies Supplier Manager to proceed to next connection</li>
                                <li>Cleans up Connection1-specific resources</li>
                                <li>Triggers transition to next priority connection</li>
                            </ul>
                            <div class="process-detail">
                                <h5>Process Details:</h5>
                                <p>This function finalizes the sync for Connection1 and prepares the system to move to the next priority connection. It updates analytics, cleans up resources, and signals the Supplier Manager that it's time to process the next connection in the priority queue.</p>
                            </div>
                            <div class="section-title">Hooks:</div>
                            <div class="hook-name">mo_wcps_connection_completed</div>
                            <p>Called when each connection sync completes</p>
                            <button class="sync-button" onclick="nextNewStep(7)">Continue</button>
                        </div>
                    </div>

                    <div class="step-container hidden" id="new-step-7">
                        <div class="step-header">
                            <span class="step-number">7</span>
                            <h4>Start Connection2 (Priority 2)</h4>
                        </div>
                        <div class="step-content">
                            <div class="step-animation">
                                <div class="process-box">Connection Manager</div>
                                <div class="arrow">→</div>
                                <div class="process-box">start_connection_sync(connection2)</div>
                            </div>
                            <div class="section-title">Function:</div>
                            <div class="function-name">start_connection_sync(connection2)</div>
                            <div class="section-title">What it does:</div>
                            <ul>
                                <li>Initiates sync for the second priority connection (Connection2)</li>
                                <li>Sets Connection2 status to 'in_progress'</li>
                                <li>Creates Connection2-specific analytics tracking</li>
                                <li>Sets up Connection2-level backup monitoring</li>
                                <li>Prepares Connection2 for API data retrieval</li>
                            </ul>
                            <div class="process-detail">
                                <h5>Process Details:</h5>
                                <p>After Connection1 completes, the system automatically moves to Connection2. This function sets up the same infrastructure as Connection1 but for the second priority connection. The sequential processing ensures that connections are synced in the correct priority order.</p>
                            </div>
                            <div class="section-title">Hooks:</div>
                            <div class="hook-name">mo_wcps_perform_action_before_connection_sync</div>
                            <p>Called before each connection sync starts</p>
                            <button class="sync-button" onclick="nextNewStep(8)">Continue</button>
                        </div>
                    </div>

                    <div class="step-container hidden" id="new-step-8">
                        <div class="step-header">
                            <span class="step-number">8</span>
                            <h4>Connection2 Processing & Completion</h4>
                        </div>
                        <div class="step-content">
                            <div class="step-animation">
                                <div class="process-box">Connection2</div>
                                <div class="arrow">→</div>
                                <div class="process-box">API Processing</div>
                                <div class="arrow">→</div>
                                <div class="process-box success">Completed</div>
                            </div>
                            <div class="section-title">Process:</div>
                            <p>Same as Connection1 but for Connection2</p>
                            <div class="section-title">Functions:</div>
                            <ul>
                                <li>handle_api_sync(connection2) - Processes products for Connection2</li>
                                <li>connection2_completed() - Finalizes Connection2 sync</li>
                            </ul>
                            <div class="process-detail">
                                <h5>Process Details:</h5>
                                <p>Connection2 goes through the same sync process as Connection1: API data retrieval, product processing, WooCommerce integration, and completion. The system maintains the same quality and consistency across all connections while respecting the priority order.</p>
                            </div>
                            <div class="section-title">Hooks:</div>
                            <div class="hook-name">mo_wcps_perform_action_before_connection_sync</div>
                            <p>Called before Connection2 sync starts</p>
                            <div class="hook-name">mo_wcps_data_alteration_filter</div>
                            <p>Called during Connection2 product processing</p>
                            <div class="hook-name">mo_wcps_connection_completed</div>
                            <p>Called when Connection2 sync completes</p>
                            <button class="sync-button" onclick="nextNewStep(9)">Continue</button>
                        </div>
                    </div>

                    <div class="step-container hidden" id="new-step-9">
                        <div class="step-header">
                            <span class="step-number">9</span>
                            <h4>Start Connection3 (Priority 3)</h4>
                        </div>
                        <div class="step-content">
                            <div class="step-animation">
                                <div class="process-box">Connection Manager</div>
                                <div class="arrow">→</div>
                                <div class="process-box">start_connection_sync(connection3)</div>
                            </div>
                            <div class="section-title">Function:</div>
                            <div class="function-name">start_connection_sync(connection3)</div>
                            <div class="section-title">What it does:</div>
                            <ul>
                                <li>Initiates sync for the final priority connection (Connection3)</li>
                                <li>Sets Connection3 status to 'in_progress'</li>
                                <li>Creates Connection3-specific analytics tracking</li>
                                <li>Sets up Connection3-level backup monitoring</li>
                                <li>Prepares Connection3 for API data retrieval</li>
                            </ul>
                            <div class="process-detail">
                                <h5>Process Details:</h5>
                                <p>After Connection2 completes, the system automatically moves to Connection3, the final connection in the priority queue. This function sets up the same infrastructure for the last connection, ensuring all connections are processed in the correct order.</p>
                            </div>
                            <div class="section-title">Hooks:</div>
                            <div class="hook-name">mo_wcps_perform_action_before_connection_sync</div>
                            <p>Called before Connection3 sync starts</p>
                            <button class="sync-button" onclick="nextNewStep(10)">Continue</button>
                        </div>
                    </div>

                    <div class="step-container hidden" id="new-step-10">
                        <div class="step-header">
                            <span class="step-number">10</span>
                            <h4>Connection3 Processing & Completion</h4>
                        </div>
                        <div class="step-content">
                            <div class="step-animation">
                                <div class="process-box">Connection3</div>
                                <div class="arrow">→</div>
                                <div class="process-box">API Processing</div>
                                <div class="arrow">→</div>
                                <div class="process-box success">Completed</div>
                            </div>
                            <div class="section-title">Process:</div>
                            <p>Same as previous connections but for Connection3</p>
                            <div class="section-title">Functions:</div>
                            <ul>
                                <li>handle_api_sync(connection3) - Processes products for Connection3</li>
                                <li>connection3_completed() - Finalizes Connection3 sync</li>
                            </ul>
                            <div class="process-detail">
                                <h5>Process Details:</h5>
                                <p>Connection3 goes through the same sync process as the previous connections: API data retrieval, product processing, WooCommerce integration, and completion. This is the final connection in the priority queue, and once it completes, the entire supplier sync will be finished.</p>
                            </div>
                            <div class="section-title">Hooks:</div>
                            <div class="hook-name">mo_wcps_perform_action_before_connection_sync</div>
                            <p>Called before Connection3 sync starts</p>
                            <div class="hook-name">mo_wcps_data_alteration_filter</div>
                            <p>Called during Connection3 product processing</p>
                            <div class="hook-name">mo_wcps_connection_completed</div>
                            <p>Called when Connection3 sync completes</p>
                            <button class="sync-button" onclick="nextNewStep(11)">Continue</button>
                        </div>
                    </div>

                    <div class="step-container hidden" id="new-step-11">
                        <div class="step-header">
                            <span class="step-number">11</span>
                            <h4>Supplier Sync Completion</h4>
                        </div>
                        <div class="step-content">
                            <div class="step-animation">
                                <div class="process-box">Supplier Manager</div>
                                <div class="arrow">→</div>
                                <div class="process-box">end_supplier_sync()</div>
                                <div class="arrow">→</div>
                                <div class="process-box success">All Connections Completed</div>
                            </div>
                            <div class="section-title">Function:</div>
                            <div class="function-name">end_supplier_sync()</div>
                            <div class="section-title">What it does:</div>
                            <ul>
                                <li>Confirms all connections have completed successfully</li>
                                <li>Updates supplier analytics with final statistics</li>
                                <li>Marks supplier sync as completed in database</li>
                                <li>Cleans up supplier-level resources and monitoring</li>
                                <li>Logs final supplier sync results and any errors</li>
                                <li>Triggers supplier completion notifications</li>
                            </ul>
                            <div class="process-detail">
                                <h5>Process Details:</h5>
                                <p>This function finalizes the entire supplier sync process after all connections have completed. It aggregates analytics from all connections, updates the supplier status, cleans up resources, and provides a comprehensive summary of the entire supplier sync operation.</p>
                            </div>
                            <div class="section-title">Hooks:</div>
                            <div class="hook-name">mo_wcps_supplier_sync_completed</div>
                            <p>Called when all connections complete, allows custom actions</p>
                            <button class="sync-button reset" onclick="resetNewSync()">Reset Simulation</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Comparison Tab -->
        <div id="comparison" class="tab-content">
            <div class="content-header">
                <h2>Key Differences Analysis</h2>
                <p>Comprehensive comparison between connection-centric vs supplier-centric approaches</p>
            </div>

            <div class="comparison-grid">
                <div class="comparison-item">
                    <h3>Old Approach: Connection-Centric</h3>
                    <ul>
                        <li>Each API = Separate connection</li>
                        <li>Manual sync for each connection</li>
                        <li>Individual scheduling required</li>
                        <li>No relationship between connections</li>
                        <li>User must manage each connection</li>
                        <li>Time-consuming for multiple APIs</li>
                        <li>Error-prone manual coordination</li>
                        <li>Isolated monitoring per connection</li>
                        <li>Basic backup monitoring</li>
                        <li>Single-level recovery mechanisms</li>
                    </ul>
                </div>
                <div class="comparison-item">
                    <h3>New Approach: Supplier-Centric</h3>
                    <ul>
                        <li>One supplier = Multiple connections</li>
                        <li>Single supplier sync operation</li>
                        <li>Automatic internal coordination</li>
                        <li>Priority-based connection processing</li>
                        <li>System manages all connections</li>
                        <li>Efficient for multiple APIs</li>
                        <li>Automated sequential processing</li>
                        <li>Unified supplier-level monitoring</li>
                        <li>Advanced multi-level backup monitoring</li>
                        <li>Enhanced recovery mechanisms</li>
                    </ul>
                </div>
            </div>

            <div class="key-differences">
                <h3>Key Improvements in New Approach</h3>
                <ul>
                    <li><strong>Simplified User Experience:</strong> One-click supplier sync instead of managing multiple connections</li>
                    <li><strong>Automated Coordination:</strong> System handles connection sequencing internally</li>
                    <li><strong>Priority Management:</strong> Intelligent processing order based on connection priorities</li>
                    <li><strong>Reduced Manual Work:</strong> No need to schedule and monitor each connection separately</li>
                    <li><strong>Better Organization:</strong> Logical grouping of related connections under suppliers</li>
                    <li><strong>Enhanced Reliability:</strong> Automated error handling and recovery mechanisms</li>
                    <li><strong>Scalability:</strong> Easy to add new connections without changing user workflow</li>
                    <li><strong>Unified Monitoring:</strong> Single dashboard for entire supplier sync progress</li>
                    <li><strong>Advanced Backup System:</strong> Multi-level backup monitoring (supplier + connection levels)</li>
                    <li><strong>Intelligent Recovery:</strong> Automatic transition between connections during recovery</li>
                </ul>
            </div>

            <div class="flow-description">
                <h4>Backup Flow Improvements</h4>
                <p><strong>Old Backup Approach:</strong> Simple connection-level monitoring with basic recovery mechanisms. Only monitors one connection at a time and may require manual intervention for complex issues.</p>
                <p><strong>New Backup Approach:</strong> Comprehensive multi-level monitoring system that tracks both supplier progress and individual connection status. Automatically handles transitions between connections, respects priority order during recovery, and provides enhanced hooks for customization.</p>
            </div>

            <div class="flow-description">
                <h4>Migration Benefits</h4>
                <p>The new supplier-centric approach transforms the user experience from managing multiple isolated connections to managing logical supplier groups. This reduces manual work, improves reliability, and provides better scalability for suppliers with multiple API connections. The automated internal coordination ensures efficient processing while maintaining the flexibility to prioritize critical connections. The enhanced backup system provides better monitoring and recovery capabilities across the entire supplier sync process.</p>
            </div>
        </div>
    </div>

    <script>
        // Tab switching functionality
        function showTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => {
                content.classList.remove('active');
            });

            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected tab content
            document.getElementById(tabName).classList.add('active');

            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        // Preview sub-tab switching
        function showPreviewTab(tabName) {
            // Hide all preview contents
            const previewContents = document.querySelectorAll('.preview-content');
            previewContents.forEach(content => {
                content.classList.remove('active');
            });

            // Remove active class from all preview sub-tabs
            const previewSubTabs = document.querySelectorAll('.preview-sub-tab');
            previewSubTabs.forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected preview content
            document.getElementById(tabName).classList.add('active');

            // Add active class to clicked preview sub-tab
            event.target.classList.add('active');
        }

        // Old Sync Flow Simulation Functions
        function startOldSync() {
            document.getElementById('old-step-1').classList.add('completed');
            document.getElementById('old-step-2').classList.remove('hidden');
            document.getElementById('old-step-2').scrollIntoView({ behavior: 'smooth' });
        }

        function nextOldStep(stepNumber) {
            // Mark current step as completed
            document.getElementById(`old-step-${stepNumber - 1}`).classList.add('completed');
            
            // Show next step
            document.getElementById(`old-step-${stepNumber}`).classList.remove('hidden');
            document.getElementById(`old-step-${stepNumber}`).scrollIntoView({ behavior: 'smooth' });
        }

        function resetOldSync() {
            // Hide all steps except first
            for (let i = 2; i <= 9; i++) {
                document.getElementById(`old-step-${i}`).classList.add('hidden');
                document.getElementById(`old-step-${i}`).classList.remove('completed');
            }
            
            // Reset first step
            document.getElementById('old-step-1').classList.remove('completed');
            document.getElementById('old-step-1').scrollIntoView({ behavior: 'smooth' });
        }

        // New Sync Flow Simulation Functions
        function startNewSync() {
            document.getElementById('new-step-1').classList.add('completed');
            document.getElementById('new-step-2').classList.remove('hidden');
            document.getElementById('new-step-2').scrollIntoView({ behavior: 'smooth' });
        }

        function nextNewStep(stepNumber) {
            // Mark current step as completed
            document.getElementById(`new-step-${stepNumber - 1}`).classList.add('completed');
            
            // Show next step
            document.getElementById(`new-step-${stepNumber}`).classList.remove('hidden');
            document.getElementById(`new-step-${stepNumber}`).scrollIntoView({ behavior: 'smooth' });
        }

        function resetNewSync() {
            // Hide all steps except first
            for (let i = 2; i <= 11; i++) {
                document.getElementById(`new-step-${i}`).classList.add('hidden');
                document.getElementById(`new-step-${i}`).classList.remove('completed');
            }
            
            // Reset first step
            document.getElementById('new-step-1').classList.remove('completed');
            document.getElementById('new-step-1').scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>
</html> 